z_borr1:--z_borr1
declare @t_noa nvarchar(35)
set @t_noa = case when '#non'=[2] then '' else [2] end
declare @tmp table(
	gno nvarchar(1),
	bnoa nvarchar(35),
	bcust nvarchar(50),
	bcash float,
	bchecka float,
	bbegindate nvarchar(10),
	benddate nvarchar(10),
	bdays int,
	brate float,
	bmoney float,
	binterest float,
	btotal float,
	bpay float,
	bunpay float,
	bmemo nvarchar(200),
	baccno nvarchar(35),
	atypea nvarchar(15),
	adatea nvarchar(10),
	amoney float,
	acheckno nvarchar(35),
	aindate nvarchar(10),
	abankno nvarchar(30),
	abank nvarchar(90),
	aaccount nvarchar(50),
	amemo nvarchar(200)
)

insert into @tmp
	select '0',
		b.noa,b.custnick,b.cash,b.checka,b.begindate,b.enddate,b.days,
		b.rate,b.money,b.interest,b.total,b.pay,b.unpay,b.memo,b.accno,
		case when a.typea = '1' then '借出' when a.typea = '2' then '還款' end,
		a.datea,a.money,a.checkno,a.indate,a.bankno,a.bank,a.account,a.memo	
	from borrs a left join borr b on a.noa = b.noa
	where b.noa = @t_noa
insert into @tmp(gno,bnoa)
	select '1',bnoa from @tmp group by bnoa
select * from @tmp order by bnoa,gno;

z_borrc1:--z_borrc1
declare @t_noa nvarchar(35)
set @t_noa = case when '#non'=[2] then '' else [2] end
declare @tmp table(
	gno nvarchar(1),
	bnoa nvarchar(35),
	bcarno nvarchar(50),
	bdriver nvarchar(90),
	bcust nvarchar(90),
	bpac float,
	bcash float,
	bchecka float,
	bmoney float,
	bbegindate nvarchar(10),
	benddate nvarchar(10),
	brate float,
	bdays nvarchar(20),
	binteis float,
	bbwmoney float,
	bpadate nvarchar(10),
	bpay float,
	barrerage float,
	bmemo nvarchar(200),
	atypea nvarchar(20),
	abwmoney float,
	ainteis float,
	atotal float,
	acheckno nvarchar(35),
	abankno nvarchar(35),
	aaccount nvarchar(50),
	abank nvarchar(90),
	amoney float,
	aindate nvarchar(10)
)
insert into @tmp
	select
		'0',b.noa,b.carno,b.driver,b.cust,b.payc,b.cash,b.checka,b.money,b.begindate,b.enddate,
		b.rate,b.days,b.inteis,b.bwmoney,b.paydate,b.pay,b.arrerage,b.memo,
		case when a.typea = '1' then '借出' when a.typea = '2' then '還款' end,
		a.bwmoney,a.inteis,a.total,a.checkno,a.bankno,a.account,a.bank,a.money,a.indate
	from borrcs a left join borrc b on a.noa = b.noa
	where b.noa = @t_noa
insert into @tmp(gno,bnoa)
	select '1',bnoa from @tmp group by bnoa
select * from @tmp order by bnoa,gno;