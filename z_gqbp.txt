z_gqbp1:--z_gqbp1
	SET QUOTED_IDENTIFIER OFF
	declare @t_accy nvarchar(20)
	declare @t_bgqbno nvarchar(20)
	declare @t_egqbno nvarchar(20)

	set @t_accy = [1]
	set @t_bgqbno = case when '#non'=[2] then '' else [2] end
	set @t_egqbno = case when '#non'=[3] then char(255) else [3] end

	declare @gqbno nvarchar(20)
	declare @money float
	declare @string1 nvarchar(max)
	declare @string2 nvarchar(max)
	declare @cmoney1 nvarchar(20)
	declare @cmoney2 nvarchar(20)
	declare @t_money int
	
	declare @tmp table(
		gno nvarchar(3),
		noa nvarchar(20),
		gqbno nvarchar(20),
		comp nvarchar(20),
		datea nvarchar(10),
		[money] float,
		cmoney1 nvarchar(20),
		cmoney2  nvarchar(20),
		memo nvarchar(90),
		indate nvarchar(20)
	)

	insert into @tmp 
	select '0',noa,gqbno,tcomp,datea,isnull([money],0),'','',case when LEN(comp)>0 then comp else memo end,indate 
	from gqb where (gqbno between @t_bgqbno and @t_egqbno) order by gqbno
	
	
	set @string1 ="壹貳參肆伍陸柒捌玖"
	declare cursor_table cursor for
	select gqbno,[money]  from  @tmp
	open cursor_table
	fetch next from cursor_table
	into @gqbno,@money
	while(@@FETCH_STATUS <> -1)
	begin
		set @cmoney1 = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,@money),1)),4,12))
		if @money=0
			set @cmoney2 = "零元整 "
		else
		begin
			print  @money
			set @cmoney2 = "元整"
			set @t_money=cast(@money as int)%10
			if not @t_money=0
			begin	
				set @cmoney2 = substring(@string1,@t_money,1)+@cmoney2
			end
			set @t_money=floor(cast(@money as int)%100/10)
			if not @t_money=0
			begin	
				set @cmoney2 = substring(@string1,@t_money,1)+'拾'+@cmoney2
			end
			set @t_money=floor(cast(@money as int)%1000/100)
			if not @t_money=0
			begin	
				set @cmoney2 = substring(@string1,@t_money,1)+'佰'+@cmoney2
			end
			set @t_money=floor(cast(@money as int)%10000/1000)
			if not @t_money=0
			begin	
				set @cmoney2 = substring(@string1,@t_money,1)+'仟'+@cmoney2
			end
			set @t_money=floor(cast(@money as int)%100000/10000)
			if not @t_money=0
			begin
				set @cmoney2 = substring(@string1,@t_money,1)+'萬'+@cmoney2
			end
			if floor(cast(@money as int)%100000000/10000)>=10
			begin
				set @cmoney2 = '萬'+@cmoney2
			end
			set @t_money=floor(cast(@money as int)%1000000/100000)
			if not @t_money=0
			begin
				set @cmoney2 = substring(@string1,@t_money,1)+'拾'+@cmoney2
			end
			set @t_money=floor(cast(@money as int)%10000000/1000000)
			if not @t_money=0
			begin
				set @cmoney2 = substring(@string1,@t_money,1)+'佰'+@cmoney2
			end
			set @t_money=floor(cast(@money as int)%100000000/10000000)
			if not @t_money=0
			begin
				set @cmoney2 = substring(@string1,@t_money,1)+'仟'+@cmoney2
			end
			set @t_money=floor(cast(@money as int)%1000000000/100000000)
			if not @t_money=0
			begin
				set @cmoney2 = substring(@string1,@t_money,1)+'億'+@cmoney2
			end
		end
		update @tmp set cmoney1=@cmoney1,cmoney2=@cmoney2 where gqbno=@gqbno
		fetch next from cursor_table
		into @gqbno,@money
	end
	close cursor_table
	deallocate cursor_table
	--insert into @tmp select '1',noa,comp,datea,[money],cmoney1,cmoney2 from @tmp
	select comp aa,cmoney1 bb,LEFT(indate,3) yy,SUBSTRING(indate,5,2) mm,RIGHT(indate,2) dd,* from @tmp order  by  gqbno,gno;
--*************************************************************************************************************************************
z_gqbp2:--z_gqab2
	SET QUOTED_IDENTIFIER OFF
	declare @t_accy nvarchar(20)
	declare @t_bgqbno nvarchar(20)
	declare @t_egqbno nvarchar(20)

	set @t_accy = [1]
	set @t_bgqbno = case when '#non'=[2] then '' else [2] end
	set @t_egqbno = case when '#non'=[3] then char(255) else [3] end

	declare @gqbno nvarchar(20)
	declare @money float
	declare @string1 nvarchar(max)
	declare @string2 nvarchar(max)
	declare @cmoney1 nvarchar(20)
	declare @cmoney2 nvarchar(20)
	declare @t_money int
	
	declare @tmp table(
		gno nvarchar(3),
		noa nvarchar(20),
		gqbno nvarchar(20),
		comp nvarchar(20),
		datea nvarchar(10),
		[money] float,
		cmoney1 nvarchar(20),
		cmoney2  nvarchar(20),
		memo nvarchar(90),
		indate nvarchar(20)
	)

	insert into @tmp 
	select '0',noa,gqbno,tcomp,datea,isnull([money],0),'','',case when LEN(comp)>0 then comp else memo end,indate 
	from gqb where (gqbno between @t_bgqbno and @t_egqbno) order by gqbno
	
	
	set @string1 ="壹貳參肆伍陸柒捌玖"
	declare cursor_table cursor for
	select gqbno,[money]  from  @tmp
	open cursor_table
	fetch next from cursor_table
	into @gqbno,@money
	while(@@FETCH_STATUS <> -1)
	begin
		set @cmoney1 = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,@money),1)),4,12))
		if @money=0
			set @cmoney2 = "零元整 "
		else
		begin
			print  @money
			set @cmoney2 = "元整"
			set @t_money=cast(@money as int)%10
			if not @t_money=0
			begin	
				set @cmoney2 = substring(@string1,@t_money,1)+@cmoney2
			end
			set @t_money=floor(cast(@money as int)%100/10)
			if not @t_money=0
			begin	
				set @cmoney2 = substring(@string1,@t_money,1)+'拾'+@cmoney2
			end
			set @t_money=floor(cast(@money as int)%1000/100)
			if not @t_money=0
			begin	
				set @cmoney2 = substring(@string1,@t_money,1)+'佰'+@cmoney2
			end
			set @t_money=floor(cast(@money as int)%10000/1000)
			if not @t_money=0
			begin	
				set @cmoney2 = substring(@string1,@t_money,1)+'仟'+@cmoney2
			end
			set @t_money=floor(cast(@money as int)%100000/10000)
			if not @t_money=0
			begin
				set @cmoney2 = substring(@string1,@t_money,1)+'萬'+@cmoney2
			end
			if floor(cast(@money as int)%100000000/10000)>=10
			begin
				set @cmoney2 = '萬'+@cmoney2
			end
			set @t_money=floor(cast(@money as int)%1000000/100000)
			if not @t_money=0
			begin
				set @cmoney2 = substring(@string1,@t_money,1)+'拾'+@cmoney2
			end
			set @t_money=floor(cast(@money as int)%10000000/1000000)
			if not @t_money=0
			begin
				set @cmoney2 = substring(@string1,@t_money,1)+'佰'+@cmoney2
			end
			set @t_money=floor(cast(@money as int)%100000000/10000000)
			if not @t_money=0
			begin
				set @cmoney2 = substring(@string1,@t_money,1)+'仟'+@cmoney2
			end
			set @t_money=floor(cast(@money as int)%1000000000/100000000)
			if not @t_money=0
			begin
				set @cmoney2 = substring(@string1,@t_money,1)+'億'+@cmoney2
			end
		end
		update @tmp set cmoney1=@cmoney1,cmoney2=@cmoney2 where gqbno=@gqbno
		fetch next from cursor_table
		into @gqbno,@money
	end
	close cursor_table
	deallocate cursor_table
	--insert into @tmp select '1',noa,comp,datea,[money],cmoney1,cmoney2 from @tmp
	select comp aa,cmoney1 bb,LEFT(indate,3) yy,SUBSTRING(indate,5,2) mm,RIGHT(indate,2) dd,* from @tmp order  by  gqbno,gno;
	--*******************************************************************************************************************************************
z_gqbp3:--z_gqab3
	SET QUOTED_IDENTIFIER OFF
	declare @t_accy nvarchar(20)
	declare @t_bgqbno nvarchar(20)
	declare @t_egqbno nvarchar(20)

	set @t_accy = [1]
	set @t_bgqbno = case when '#non'=[2] then '' else [2] end
	set @t_egqbno = case when '#non'=[3] then char(255) else [3] end

	declare @gqbno nvarchar(20)
	declare @money float
	declare @string1 nvarchar(max)
	declare @string2 nvarchar(max)
	declare @cmoney1 nvarchar(20)
	declare @cmoney2 nvarchar(20)
	declare @t_money int
	
	declare @tmp table(
		gno nvarchar(3),
		noa nvarchar(20),
		gqbno nvarchar(20),
		comp nvarchar(20),
		datea nvarchar(10),
		[money] float,
		cmoney1 nvarchar(20),
		cmoney2  nvarchar(20),
		memo nvarchar(90),
		indate nvarchar(20)
	)

	insert into @tmp 
	select '0',noa,gqbno,tcomp,datea,isnull([money],0),'','',case when LEN(comp)>0 then comp else memo end,indate 
	from gqb where (gqbno between @t_bgqbno and @t_egqbno) order by gqbno
	
	
	set @string1 ="壹貳參肆伍陸柒捌玖"
	declare cursor_table cursor for
	select gqbno,[money]  from  @tmp
	open cursor_table
	fetch next from cursor_table
	into @gqbno,@money
	while(@@FETCH_STATUS <> -1)
	begin
		set @cmoney1 = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,@money),1)),4,12))
		if @money=0
			set @cmoney2 = "零元整 "
		else
		begin
			print  @money
			set @cmoney2 = "元整"
			set @t_money=cast(@money as int)%10
			if not @t_money=0
			begin	
				set @cmoney2 = substring(@string1,@t_money,1)+@cmoney2
			end
			set @t_money=floor(cast(@money as int)%100/10)
			if not @t_money=0
			begin	
				set @cmoney2 = substring(@string1,@t_money,1)+'拾'+@cmoney2
			end
			set @t_money=floor(cast(@money as int)%1000/100)
			if not @t_money=0
			begin	
				set @cmoney2 = substring(@string1,@t_money,1)+'佰'+@cmoney2
			end
			set @t_money=floor(cast(@money as int)%10000/1000)
			if not @t_money=0
			begin	
				set @cmoney2 = substring(@string1,@t_money,1)+'仟'+@cmoney2
			end
			set @t_money=floor(cast(@money as int)%100000/10000)
			if not @t_money=0
			begin
				set @cmoney2 = substring(@string1,@t_money,1)+'萬'+@cmoney2
			end
			if floor(cast(@money as int)%100000000/10000)>=10
			begin
				set @cmoney2 = '萬'+@cmoney2
			end
			set @t_money=floor(cast(@money as int)%1000000/100000)
			if not @t_money=0
			begin
				set @cmoney2 = substring(@string1,@t_money,1)+'拾'+@cmoney2
			end
			set @t_money=floor(cast(@money as int)%10000000/1000000)
			if not @t_money=0
			begin
				set @cmoney2 = substring(@string1,@t_money,1)+'佰'+@cmoney2
			end
			set @t_money=floor(cast(@money as int)%100000000/10000000)
			if not @t_money=0
			begin
				set @cmoney2 = substring(@string1,@t_money,1)+'仟'+@cmoney2
			end
			set @t_money=floor(cast(@money as int)%1000000000/100000000)
			if not @t_money=0
			begin
				set @cmoney2 = substring(@string1,@t_money,1)+'億'+@cmoney2
			end
		end
		update @tmp set cmoney1=@cmoney1,cmoney2=@cmoney2 where gqbno=@gqbno
		fetch next from cursor_table
		into @gqbno,@money
	end
	close cursor_table
	deallocate cursor_table
	--insert into @tmp select '1',noa,comp,datea,[money],cmoney1,cmoney2 from @tmp
	select comp aa,cmoney1 bb,LEFT(indate,3) yy,SUBSTRING(indate,5,2) mm,RIGHT(indate,2) dd,* from @tmp order  by  gqbno,gno;