z_ordestp1:--z_ordestp1
declare @t_bdate nvarchar(20)
declare @t_edate nvarchar(20)
declare @t_noa nvarchar(30)
set @t_bdate = case when '#non' = [2] then '' else [2] end
set @t_edate = case when '#non' = [3] then CHAR(255) else [3] end
set @t_noa = case when '#non' = [4] then '' else [4] end
declare @tmp table(
	gno nvarchar(1),
	noa nvarchar(35),
	comp nvarchar(50),
	addr nvarchar(max),
	products nvarchar(90),
	productno nvarchar(35),
	spec nvarchar(15),
	size nvarchar(200),
	mount float,
	unit nvarchar(10),
	price float,
	total float,
	weight float
)
insert into @tmp
select
	'0',b.noa,b.comp,b.addr2,a.product,a.productno,a.spec,
	case  upper(left(b.kind,1))
		when 'A' then cast(a.dime as nvarchar) + ' x ' + cast(a.width as nvarchar) + ' x ' + cast(a.lengthb as nvarchar) 
		when 'B' then cast(a.radius as nvarchar) + ' x ' + cast(a.width as nvarchar) + ' x ' + cast(a.dime as nvarchar) + ' x ' + cast(a.lengthb as nvarchar) 
		else cast(a.lengthb as nvarchar)
	end size,
	a.mount,a.unit,a.price,a.total,a.weight
from ordes[1] a
left join orde[1] b on a.noa = b.noa
where b.datea between @t_bdate and @t_edate and (len(@t_noa) = 0 or b.noa = @t_noa)
insert into @tmp(gno,noa)
	select '1',noa from @tmp group by noa
select * from @tmp order by noa,gno;
