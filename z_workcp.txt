z_workcp1:--z_workcp1
declare @t_btggno nvarchar(20)
declare @t_etggno nvarchar(20)
set @t_btggno = case when '#non' = [5] then '' else [5] end
set @t_etggno = case when '#non' = [6] then CHAR(255) else [6] end
declare @tmp table(
	gno nvarchar(1),
	bnoa nvarchar(30),
	btggno nvarchar(30),
	btggs nvarchar(90),
	bstoreno nvarchar(30),
	bstores nvarchar(90),
	bproductno nvarchar(30),
	bproducts nvarchar(90),
	aproductno nvarchar(30),
	aproducts nvarchar(90),
	amount float,
	aunit nvarchar(12),
	amemo nvarchar(max)
)
insert into @tmp
	select
		'0',b.noa,b.tggno,b.tgg,b.storeno,b.store,b.productno,b.product,a.productno,a.product,a.mount,a.unit,a.memo
	from workcs[1] a
	left join workc[1] b on a.noa = b.noa
	where b.tggno between @t_btggno and @t_etggno
	order by b.noa,b.productno
insert into @tmp(gno,bnoa)
	select '1',bnoa from @tmp group by bnoa
select * from @tmp order by bnoa,gno,btggno;
z_workcp2:--z_workcp2
declare @tmp table(
	gno nvarchar(1),
	tggno nvarchar(30),
	tggs nvarchar(90),
	addrs_comp nvarchar(max),
	addrs_fact nvarchar(max),
	addrs_invo nvarchar(max),
	tel nvarchar(50),
	fax nvarchar(50),
	process nvarchar(30),
	bproductno nvarchar(30),
	bproducts nvarchar(90),
	bcuadate nvarchar(10),
	buindate nvarchar(10),
	bmount float,
	bunit nvarchar(12),
	bprice float,
	btotal float,
	anoq nvarchar(3),
	aproductno nvarchar(30),
	aproducts nvarchar(90),
	acuadate nvarchar(10),
	amount float,
	aunit nvarchar(12)
)
insert into @tmp
select
	'0',b.tggno,d.comp,d.addr_comp,d.addr_fact,d.addr_invo,d.tel,d.fax,
	b.process,b.productno,b.product,c.cuadate,c.uindate,
	c.mount,c.unit,c.price,(isnull(c.mount,0)*isnull(c.price,0)) total,
	a.noq,a.productno,a.product,b.cuadate,a.mount,a.unit
from workcs[1] a
left join workc[1] b on a.noa = b.noa
left join work[1] c on b.workno = c.noa
left join tgg d on b.tggno = d.noa
select * from @tmp;