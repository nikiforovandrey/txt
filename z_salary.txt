z_salary1:--z_salary1
declare @t_xmon nvarchar(20)
declare @t_xmonkind nvarchar(20)
set @t_xmon = case when '#non' = [1] then '' else [1] end
set @t_xmonkind = case when '#non' = [2] then '' else [2] end
declare @tmp table(
		gno nvarchar(1),
		noa nvarchar(30),
		noq nvarchar(20),
		part nvarchar(20),
		indate nvarchar(10),
		sno nvarchar(20),
		namea nvarchar(50),
		sal int,
		boa int,
		bot int,
		bos int,
		boo int,
		atotal int,
		chl int,
		chla int,
		chh int,
		mito int,
		bof int,
		taxo int,
		btotal int,
		add1 int,
		add2 int,
		addm int,
		taxn int,
		ctotal int,
		chgs int,
		lach int,
		chlco int,
		chlse int,
		l int,
		taxp int,
		wel int,
		hech int,
		etotal int,
		ftotal int
)
insert into @tmp
select '0' gno,a.noa,b.noq,c.part,c.indate,b.sno,b.namea,b.money,b.bo_admin,b.bo_traffic,b.bo_special,b.bo_oth,b.total1,
b.ch_labor1,b.ch_labor2,b.ch_health_insure,b.mi_total,b.bo_full,b.tax_other,b.total2,b.addh2_1,b.addh2_2,
b.addmoney,b.tax_other2,b.total3,b.chg,b.ch_labor,b.ch_labor_comp,b.ch_labor_self,b.lodging_power_fee,b.tax5,
b.welfare,b.ch_health,b.total4,b.total5
from salary a
left join salarys b on a.noa = b.noa
left join sss c on c.noa = b.sno
where (LEN(@t_xmon) = 0 or @t_xmon = a.mon) and
(LEN(@t_xmonkind) = 0 or @t_xmonkind = a.monkind) 


insert into @tmp
select '1' gno,'','',part,'','','',sum(sal),sum(boa),sum(bot),sum(bos),sum(boo),sum(atotal),sum(chl),
	sum(chla),SUM(chh),sum(mito),sum(bof),sum(taxo),sum(btotal),sum(add1),sum(add2),sum(addm),sum(taxn),sum(ctotal),
	sum(chgs),sum(lach),sum(chlco),sum(chlse),sum(l),sum(taxp),sum(wel),sum(hech),sum(etotal),sum(ftotal)
from @tmp
group by part

select gno,noa,noq,part,indate,sno,namea,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,sal),1)),4,12)) sal,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,boa),1)),4,12)) boa,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,bot),1)),4,12)) bot,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,bos),1)),4,12)) bos,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,boo),1)),4,12)) boo,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,atotal),1)),4,12)) atotal,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,chl),1)),4,12)) chl,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,chla),1)),4,12)) chla,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,chh),1)),4,12)) chh,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,mito),1)),4,12)) mito,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,bof),1)),4,12)) bof,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,taxo),1)),4,12)) taxo,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,btotal),1)),4,12)) btotal,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,add1),1)),4,12)) add1,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,add2),1)),4,12)) add2,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,addm),1)),4,12)) addm,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,taxn),1)),4,12)) taxn,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,ctotal),1)),4,12)) ctotal,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,chgs),1)),4,12)) chgs,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,lach),1)),4,12)) lach,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,chlco),1)),4,12))chlco,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,chlse),1)),4,12))chlse,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,l),1)),4,12)) l,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,taxp),1)),4,12)) taxp,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,wel),1)),4,12)) wel,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,hech),1)),4,12)) hech,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,etotal),1)),4,12)) etotal,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,ftotal),1)),4,12)) ftotal

from @tmp;
------------------------------------------------------------------------------------------------------------------------------
z_salary2:--z_salary2
declare @t_xmon nvarchar(20)
declare @t_xmonkind nvarchar(20)
set @t_xmon = case when '#non' = [1] then '' else [1] end
set @t_xmonkind = case when '#non' = [2] then '' else [2] end
declare @tmp table(
		gno nvarchar(1),
		noa nvarchar(30),
		noq nvarchar(20),
		part nvarchar(20),
		indate nvarchar(10),
		sno nvarchar(20),
		namea nvarchar(50),
		sal int,
		boa int,
		bot int,
		bos int,
		boo int,
		atotal int,
		chl int,
		chla int,
		chh int,
		mito int,
		bof int,
		taxo int,
		btotal int,
		add1 int,
		add2 int,
		addm int,
		taxn int,
		ctotal int,
		chgs int,
		lach int,
		chlco int,
		chlse int,
		l int,
		taxp int,
		wel int,
		hech int,
		etotal int,
		ftotal int,
		misd int,
		tax int
)
insert into @tmp
select '0' gno,a.noa,b.noq,c.part,c.indate,b.sno,b.namea,b.money,b.bo_admin,b.bo_traffic,b.bo_special,b.bo_oth,b.total1,
b.ch_labor1,b.ch_labor2,b.ch_health_insure,b.mi_total,b.bo_full,b.tax_other,b.total2,b.addh2_1,b.addh2_2,
b.addmoney,b.tax_other2,b.total3,b.chg,b.ch_labor,b.ch_labor_comp,b.ch_labor_self,b.lodging_power_fee,b.tax5,
b.welfare,b.ch_health,b.total4,b.total5,b.mi_saliday,b.tax
from salary a
left join salarys b on a.noa = b.noa
left join sss c on c.noa = b.sno
where (LEN(@t_xmon) = 0 or @t_xmon = a.mon) and
(LEN(@t_xmonkind) = 0 or @t_xmonkind = a.monkind) 


insert into @tmp
select '1' gno,'','',part,'','','',sum(sal),sum(boa),sum(bot),sum(bos),sum(boo),sum(atotal),sum(chl),
	sum(chla),SUM(chh),sum(mito),sum(bof),sum(taxo),sum(btotal),sum(add1),sum(add2),sum(addm),sum(taxn),sum(ctotal),
	sum(chgs),sum(lach),sum(chlco),sum(chlse),sum(l),sum(taxp),sum(wel),sum(hech),sum(etotal),sum(ftotal),0,SUM(tax)
from @tmp
group by part

select gno,noa,noq,part,indate,sno,namea,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,sal),1)),4,12)) sal,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,boa),1)),4,12)) boa,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,bot),1)),4,12)) bot,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,bos),1)),4,12)) bos,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,boo),1)),4,12)) boo,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,atotal),1)),4,12)) atotal,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,chl),1)),4,12)) chl,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,chla),1)),4,12)) chla,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,chh),1)),4,12)) chh,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,mito),1)),4,12)) mito,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,bof),1)),4,12)) bof,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,taxo),1)),4,12)) taxo,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,btotal),1)),4,12)) btotal,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,add1),1)),4,12)) add1,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,add2),1)),4,12)) add2,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,addm),1)),4,12)) addm,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,taxn),1)),4,12)) taxn,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,ctotal),1)),4,12)) ctotal,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,chgs),1)),4,12)) chgs,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,lach),1)),4,12)) lach,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,chlco),1)),4,12))chlco,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,chlse),1)),4,12))chlse,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,l),1)),4,12)) l,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,taxp),1)),4,12)) taxp,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,wel),1)),4,12)) wel,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,hech),1)),4,12)) hech,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,etotal),1)),4,12)) etotal,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,ftotal),1)),4,12)) ftotal,misd,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,tax),1)),4,12)) tax
from @tmp;