z_cub1:--z_cub1
declare @t_bdate nvarchar(10)
declare @t_edate nvarchar(10)
declare @t_bnoa nvarchar(50)
declare @t_enoa nvarchar(50)

set @t_bdate = case when '#non' = [2] then ' ' else [2] end
set @t_edate = case when '#non' = [3] then CHAR(255) else [3] end
set @t_bnoa = case when '#non' = [4] then ' ' else [4] end
set @t_enoa = case when '#non' = [5] then CHAR(255) else [5] end

declare @tmp table(
	gno nvarchar(1),
	noa nvarchar(30),
	cust nvarchar(90),
	productno nvarchar(30),
	products nvarchar(90),
	spec nvarchar(30),
	radius float,
	width float,
	dime float,
	lengthb float,
	mount float,
	orde_weight float,
	h_weight float,
	memo nvarchar(max),
	size nvarchar(max),
	qhref nvarchar(max)
)
insert into @tmp
	select
		'0',a.noa,isnull(b.nick,''),a.productno,a.product,a.spec,a.radius,a.width,
		a.dime,a.lengthb,a.mount,a.weight,a.hweight,a.memo,'','cubpi'+a.accy
	from view_cubs a
	left join view_cub c on a.noa=c.noa
	left join cust b on a.custno = b.noa
	where c.datea between @t_bdate and @t_edate and c.noa between @t_bnoa and @t_enoa
	order by a.noa
update @tmp set size = dbo.csize('B2',dime,width,lengthb,radius)
update @tmp set qhref = substring(qhref,0,len(qhref)-2)+'?left(noa,'+cast(len(noa) as nvarchar)+')=$noa?'+substring(qhref,len(qhref)-2,len(qhref))
select
	gno,noa,cust,productno,products,spec,size,
	reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,mount),1)),4,12)) mount,
	reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,orde_weight),1)),4,12)) orde_weight,
	reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,h_weight),1)),4,12)) h_weight,memo,qhref
from @tmp order by noa,gno;
