z_cub1:--z_cub1
declare @tmp table(
	gno nvarchar(1),
	noa nvarchar(30),
	cust nvarchar(90),
	productno nvarchar(30),
	products nvarchar(90),
	spec nvarchar(30),
	radius float,
	width float,
	dime float,
	lengthb float,
	mount float,
	orde_weight float,
	h_weight float,
	memo nvarchar(max),
	size nvarchar(max)
)
insert into @tmp
	select
		'0',a.noa,isnull(b.nick,''),a.productno,a.product,a.spec,a.radius,a.width,
		a.dime,a.lengthb,a.mount,a.weight,a.hweight,a.memo,''
	from cubs102 a
	left join cust b on a.custno = b.noa
	order by a.noa
update @tmp set size = (case when radius >0 
		then cast(radius as nvarchar) + ' x ' + cast(width as nvarchar) + ' x ' +cast(dime as nvarchar) + ' x ' +cast(lengthb as nvarchar)
		else cast(dime as nvarchar) + ' x ' + cast(width as nvarchar) + ' x ' +cast(lengthb as nvarchar) end)
select
	gno,noa,cust,productno,products,spec,size,
	reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,mount),1)),4,12)) mount,
	reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,orde_weight),1)),4,12)) orde_weight,
	reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,h_weight),1)),4,12)) h_weight,memo
from @tmp order by noa,gno;
