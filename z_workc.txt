z_workc1:--z_workc1
declare @t_btggno nvarchar(20)
declare @t_etggno nvarchar(20)
set @t_btggno = case when '#non' = [5] then '' else [5] end
set @t_etggno = case when '#non' = [6] then CHAR(255) else [6] end
declare @tmp table(
	gno nvarchar(1),
	ordeno nvarchar(30),
	no2 nvarchar(10),
	productno nvarchar(30),
	products nvarchar(90),
	workamount float,
	workmount float,
	ordcmount float,
	stockmount float
)
insert into @tmp
	select
		'0',b.ordeno,b.no2,a.productno,a.product,isnull(sum(a.mount),0),isnull(sum(c.mount),0),0,0
	from workas[1] a
	left join worka[1] b on a.noa = b.noa
	left join (
				select b.ordeno,b.no2,a.productno,sum(a.emount) mount from works[1] a
				left join work[1] b on a.noa = b.noa
				group by  b.ordeno,b.no2,a.productno
			   ) as c on (b.ordeno = c.ordeno) and (b.no2 = c.no2) and (a.productno = c.productno)
	left join work[1] d on b.workno = d.noa
				where d.tggno between @t_btggno and @t_etggno
				group by b.ordeno,b.no2,a.productno,a.product
				order by b.ordeno,a.productno
insert into @tmp(gno,ordeno,workamount,workmount)
	select '1',ordeno,sum(workamount),(sum(workamount)-sum(workmount)+sum(ordcmount)+sum(stockmount)) from @tmp
	group by ordeno
select * from @tmp order by ordeno,gno;
