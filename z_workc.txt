z_workc1:--z_workc1
declare @t_btggno nvarchar(20)
declare @t_etggno nvarchar(20)
set @t_btggno = case when '#non' = [5] then '' else [5] end
set @t_etggno = case when '#non' = [6] then CHAR(255) else [6] end
declare @tmp table(
	gno nvarchar(1),
	tggno nvarchar(30),
	comp nvarchar(90),
	productno nvarchar(30),
	products nvarchar(90),
	workmount float,
	workcmount float,
	total float
)
insert into @tmp
	select
		'0',b.tggno,b.comp,a.productno,a.product,isnull(sum(a.mount),0),isnull(sum(c.mount),0),0
	from works[1] a
	left join work[1] b on a.noa = b.noa
	left join (
		select b.workno,b.productno,sum(a.mount) mount from workcs[1] a 
		left join workc[1] b on a.noa = b.noa
		group by b.workno,b.productno
	) c on b.noa = c.workno
	where b.tggno between @t_btggno and @t_etggno
	group by b.tggno,b.comp,a.productno,a.product
update @tmp set total = workmount-workcmount
insert into @tmp(gno,tggno,comp,workmount,workcmount,total)
	select '1',tggno,comp,sum(workmount),sum(workcmount),sum(total)
	from @tmp
	group by tggno,comp
select * from @tmp;