z_ordb1:--z_ordb1
declare @tmp table(
	gno nvarchar(1),
	productno nvarchar(30),
	products nvarchar(90),
	stype nvarchar(15),
	ordeno nvarchar(30),
	ordbmount float,
	ordbunit nvarchar(12),
	ordcmount float,
	ordcunit nvarchar(12),
	price float,
	tggno nvarchar(30),
	tggs nvarchar(90),
	coin nvarchar(15),
	taxtype nvarchar(15),
	odate nvarchar(10),
	datea nvarchar(10),
	kind nvarchar(15),
	noa nvarchar(30)
)
insert into @tmp
	select 
		'0',a.productno,a.product,c.stype,c.ordeno,c.ordbmount,c.ordbunit,
		a.mount,a.unit,a.price,b.tggno,b.tgg,b.coin,b.taxtype,b.odate,b.datea,
		b.kind,b.noa
	from view_ordcs[1] a
	left join view_ordc[1] b on a.noa = b.noa
	left join (
		select a.noa ordbno,d.noa ordeno,d.no2 no2,b.no3 no3,c.stype stype,
				b.mount ordbmount,b.unit ordbunit
		from view_ordb[1] a
		left join view_ordbs[1] b on a.noa = b.noa
		left join view_orde[1] c on b.ordeno = c.noa
		left join view_ordes[1] d on (c.noa = d.noa) and (b.no2 = d.no2)
		group by a.noa,d.noa,d.no2,b.no3,c.stype,b.mount,b.unit
	) c on (a.ordbno = c.ordbno) and (a.no3 = c.no3)
update @tmp set stype = (
		case stype when '1' then '內銷' when '2' then '代工' when '3' then '外銷' when '4' then '計畫生產' end
)
update @tmp set taxtype = (
		case taxtype when '1' then '應稅' when '2' then '零稅率' when '3' then '內含' when '4' then '免稅' 
		when '5' then '自訂' when '6' then '作廢' end
)
update @tmp set kind = (
		case kind when '1' then '原料' when '2' then '物料' 
		when 'A1' then '鋼捲鋼板' when 'B2' then '鋼管' when 'C3' then '鋼筋' when 'A4' then '鋼胚'  
		end
)

select * from @tmp;