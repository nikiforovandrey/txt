z_custchg:--z_custchg
declare @t_bdate nvarchar(10)
declare @t_edate nvarchar(10)
declare @t_bcustno nvarchar(20)
declare @t_ecustno nvarchar(20)
set @t_bdate = case when '#non'=[1] then '' else [1] end
set @t_edate = case when '#non'=[2] then CHAR(255) else [2] end
set @t_bcustno = case when '#non'=[3] then '' else [3] end
set @t_ecustno = case when '#non'=[4] then CHAR(255) else [4] end
declare @result table(
		gno  nvarchar(1),
		noa nvarchar(20),
		datea nvarchar(10),
		custno nvarchar(20),
		comp nvarchar(50),
		item nvarchar(50),
		plus float,
		minus float,
		memo nvarchar(20)
)
insert into @result
select '0' gno,a.noa,a.datea,a.custno,case when len(b.nick)>0 then b.nick else left(a.comp,4) end,a.plusitem+a.minusitem,a.plusmoney,a.minusmoney,a.memo
from custchg a
left join cust b on b.noa = a.custno
where (a.datea between @t_bdate and @t_edate) and
(a.custno between @t_bcustno and @t_ecustno)

select gno,noa,datea,custno,comp,item,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,plus),1)),4,12)) plus,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,minus),1)),4,12)) minus,
memo
from @result
order by custno,datea;