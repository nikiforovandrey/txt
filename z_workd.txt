z_workd1:--z_workd1
declare @t_noa nvarchar(30) = [2]
declare @tmp table(
	gno nvarchar(1),
	anoa nvarchar(30),
	adatea nvarchar(10),
	atgg nvarchar(30),
	astore nvarchar(30),
	amemo nvarchar(200),
	bproductno nvarchar(30),
	bproduct nvarchar(90),
	bunit nvarchar(10),
	bborn float,
	bmount float,
	bprice float,
	btotal float,
	berrmount float,
	bmemo nvarchar(200),
	bordeno nvarchar(50)
)
insert into @tmp
	select
		'0',b.noa,b.datea,b.tgg,b.store,b.memo,
		a.productno,a.product,a.unit,a.born,a.mount,a.price,a.total,a.errmount,a.memo,a.ordeno + '-' +a.no2
	from workds[1] a
	left join workd[1] b on a.noa = b.noa
	where b.noa = @t_noa
select * from @tmp;
z_workd2:--z_workd2
declare @t_bdate nvarchar(10)
declare @t_edate nvarchar(10)
declare @t_btggno nvarchar(30)
declare @t_etggno nvarchar(30)
set @t_bdate = case when '#non'=[3] then '' else [3] end
set @t_edate = case when '#non'=[4] then char(255) else [4] end
set @t_btggno = case when '#non'=[5] then '' else [5] end
set @t_etggno = case when '#non'=[6] then char(255) else [6] end
declare @tmp table(
	gno nvarchar(1),
	adatea nvarchar(10),
	anoa nvarchar(30),
	atggno nvarchar(30),
	atggs nvarchar(90),
	bmount float,
	bprice float,
	btotal float,
	berrmount float
)
insert into @tmp
	select
		'0',b.datea,b.noa,b.tggno,c.nick,sum(a.mount),sum(a.price),sum(a.total),sum(a.errmount)
	from workds[1] a
	left join workd[1] b on a.noa = b.noa
	left join tgg c on b.tggno = c.noa
	where (b.tggno between @t_btggno and @t_etggno) and
		  (b.datea between @t_bdate and @t_edate)
	group by b.noa,b.datea,b.tggno,c.nick
insert into @tmp(gno,atggno,atggs,bmount,bprice,btotal,berrmount)
	select '1',atggno,atggs,sum(bmount),sum(bprice),sum(btotal),sum(berrmount)
	from @tmp
	group by atggno,atggs
select * from @tmp order by atggno,gno,adatea;