z_salpresent1:--z_salpresent1
declare @t_bdate nvarchar(20)
declare @t_edate nvarchar(20)
declare @t_xperson nvarchar(20)
set @t_bdate = case when '#non' = '#non' then '' else '#non' end
set @t_edate = case when '#non' = '#non' then CHAR(255) else '#non' end
set @t_xperson = case when '#non' = '#non' then '' else '#non' end
declare @tmp table(
		gno nvarchar(1),
		noa nvarchar(20),
		noq nvarchar(30),
		datea nvarchar(10),
		n nvarchar(20),
		sssno nvarchar(20),
		namea nvarchar(50),
		part nvarchar(20),
		a nvarchar(20),
		clockin nvarchar(20),
		e nvarchar(20),
		f nvarchar(20),
		clockout  nvarchar(20),
		memo nvarchar(50)
)
insert into @tmp
select '0' gno,a.noa,b.noq,a.noa,b.noq,b.sssno,b.namea,c.part,'',b.clockin,'','',b.clockout,b.memo
from salpresent a
left join salpresents b on a.noa = b.noa
left join sss c on b.sssno = a.noa
where (a.noa between @t_bdate and @t_edate) and
(LEN(@t_xperson) = 0 or @t_xperson = c.person)

select *
from @tmp;