z_vccep1:--z_vccep1
	declare @t_xnoa nvarchar(50)
	declare @t_bdate nvarchar(10)
	declare @t_edate nvarchar(10)
	declare @t_bcustno nvarchar(50)
	declare @t_ecustno nvarchar(50)
	declare @t_bcno nvarchar(50)
	declare @t_ecno nvarchar(50)
	declare @t_bsalesno nvarchar(50)
	declare @t_esalesno nvarchar(50)
	declare @t_bitggno nvarchar(50)
	declare @t_eitggno nvarchar(50)
	declare @t_bbtggno nvarchar(50)
	declare @t_ebtggno nvarchar(50)
	declare @t_bcldate nvarchar(10)
	declare @t_ecldate nvarchar(10)
	
	set @t_xnoa = case when '#non'=[2] then '' else [2] end
	set @t_bdate = case when '#non'=[3] then '' else [3] end
	set @t_edate = case when '#non'=[4] then char(255) else [4] end
	set @t_bcustno = case when '#non'=[5] then '' else [5] end
	set @t_ecustno = case when '#non'=[6] then char(255) else [6] end
	set @t_bcno = case when '#non'=[7] then '' else [7] end
	set @t_ecno = case when '#non'=[8] then char(255) else [8] end
	set @t_bsalesno = case when '#non'=[9] then '' else [9] end
	set @t_esalesno = case when '#non'=[10] then char(255) else [10] end
	set @t_bitggno = case when '#non'=[11] then '' else [11] end
	set @t_eitggno = case when '#non'=[12] then char(255) else [12] end
	set @t_bbtggno = case when '#non'=[13] then '' else [13] end
	set @t_ebtggno = case when '#non'=[14] then char(255) else [14] end
	set @t_bcldate = case when '#non'=[15] then '' else [15] end
	set @t_ecldate = case when '#non'=[16] then char(255) else [16] end
	
	--*****************************************************************************************	
select '0'gno 
,a.noa vcceno 
,a.datea vccedatea 
,b.cldate vcctcdate 
,b.shippingdate vcctsdate 
,b.onboarddate vcctodate 
,a.custno,f.nick comp
,a.salesno,a.sales saless 
,a.cno,a.acomp 
,b.bcompno bno,h.nick bcomp 
,b.inspection_compno icno,g.nick icomp 
,a.lcno,c.coin--,c.floata
,reverse(substring(reverse(convert(nvarchar(30),CONVERT(money,c.floata),1)),0,30)) floata
,c.onboarddate lodate,c.negotiatingdate lndate 
,d.productno pno,d.product,d.unit,d.spec--,d.mount
,reverse(substring(reverse(convert(nvarchar(30),CONVERT(money,d.mount),1)),4,30)) mount 
,e.packway,e.pack pname--,e.gweight gw,e.cuft 
,reverse(substring(reverse(convert(nvarchar(30),CONVERT(money,e.gweight),1)),0,30)) gw
,reverse(substring(reverse(convert(nvarchar(30),CONVERT(money,e.cuft ),1)),0,30)) cuft
from view_vcce102 a left join vcct b on a.noa=b.noa left join lcu c on a.lcno=c.lcno 
left join view_vcces102 d on a.noa=d.noa left join packing e on d.productno=e.productno and a.noa=e.noa 
left join cust f on a.custno=f.noa left join tgg g on b.inspection_compno=b.noa left join tgg h on b.bcompno=h.noa
where (len(@t_xnoa)=0 or a.noa=@t_xnoa) and (a.datea between @t_bdate and @t_edate)
and (isnull(a.custno,'') between @t_bcustno and @t_ecustno) and (isnull(a.cno,'') between @t_bcno and @t_ecno) 
and (isnull(a.salesno,'') between @t_bsalesno and @t_esalesno) and (isnull(b.cldate,'') between @t_bcldate and @t_ecldate) 
and (isnull(b.inspection_compno,'') between @t_bitggno and @t_eitggno) and (isnull(b.bcompno,'') between @t_bbtggno and @t_ebtggno) 


;