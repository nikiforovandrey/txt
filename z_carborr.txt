z_carborr:--z_carborr
declare @t_bdate nvarchar(10)
declare @t_edate nvarchar(10)
declare @t_bdriverno nvarchar(20)
declare @t_edriverno nvarchar(20)
set @t_bdate = case when '#non' = [1] then '' else [1] end
set @t_edate = case when '#non' = [2] then CHAR(255) else [2] end
set @t_bdriverno = case when '#non' = [3] then '' else [3] end
set @t_edriverno = case when '#non' = [4] then CHAR(255) else [4] end
declare @tmp table(
		gno nvarchar(1),
		noa nvarchar(20),
		datea nvarchar(10), 
		driverno nvarchar(20),
		driver nvarchar(50),
		moneys float,
		mon nvarchar(10),
		memo nvarchar(200)
)
insert into @tmp
select '0' gno,noa,datea,driverno,driver,money,mon,memo
from carborr
where (datea between @t_bdate and @t_edate) and
(driverno between @t_bdriverno and @t_edriverno)


insert into @tmp
select '1' gno,'','',MAX(driverno),'',sum(moneys),'',''
from @tmp


select gno,noa,datea,driverno,driver,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,moneys),1)),4,12))  moneys,
mon,memo
from @tmp
order by driverno,gno;