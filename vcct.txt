vcct:--vcct匯入發票資料
SET QUOTED_IDENTIFIER OFF
declare @mon nvarchar(MAX)=case when '#non'=[1] then '' else [1] end
declare @bdate nvarchar(MAX)=case when '#non'=[2] then '' else [2] end
declare @edate nvarchar(MAX)=case when '#non'=[3] then CHAR(255) else [3] end
declare @vcca nvarchar(MAX)=case when '#non'=[4] then '0' else [4] end
declare @rc2a nvarchar(MAX)=case when '#non'=[5] then '0' else [5] end

if(@vcca='1')
begin
	insert vcct(noa,typea,kind,datea,mon,serial,money,tax,taxtype,total)
	select noa,'2','31',datea,@mon,serial,money,tax,taxtype,total
	from vcca where datea between @bdate and @edate
	and noa not in(select noa from vcct)
end

if(@rc2a='1')
begin
	insert vcct(noa,typea,kind,datea,mon,serial,money,tax,taxtype,total)
	select noa,'1','21',datea,@mon,serial,money,tax,taxtype,total
	from rc2a where datea between @bdate and @edate
	and noa not in(select noa from vcct)
end

;