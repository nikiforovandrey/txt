z_cubu1:--z_cubu1
declare @t_bdate nvarchar(10)
declare @t_edate nvarchar(10)

set @t_bdate = case when '#non' = [4] then '' else [4] end
set @t_edate = case when '#non' = [5] then CHAR(255) else [5] end

declare @tmp table(
	gno nvarchar(1),
	datea nvarchar(10),
	noa nvarchar(35),
	uno nvarchar(90),
	mount float,
	weight float
)

insert into @tmp
	select '0',a.datea,a.noa,a.uno,isnull(a.mount,0),isnull(a.weight,0)
	from view_cubu a
	where (a.datea between @t_bdate and @t_edate) 
	
insert into @tmp(gno,mount,weight)
	select '1',sum(mount),sum(weight) from @tmp
	
select 
dbo.getComma(mount,[2]) mount,
dbo.getComma(weight,[3]) weight,
* 
from @tmp order by gno,datea,uno;