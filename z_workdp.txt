z_workdp1:--z_workdp1
declare @t_noa nvarchar(30) = [2]
declare @tmp table(
	gno nvarchar(1),
	anoa nvarchar(30),
	adatea nvarchar(10),
	atgg nvarchar(30),
	astore nvarchar(30),
	amemo nvarchar(200),
	bproductno nvarchar(30),
	bproduct nvarchar(90),
	bunit nvarchar(10),
	bborn float,
	bmount float,
	bprice float,
	btotal float,
	berrmount float,
	bmemo nvarchar(200),
	bordeno nvarchar(50)
)
insert into @tmp
	select
		'0',b.noa,b.datea,b.tgg,b.store,b.memo,
		a.productno,a.product,a.unit,a.born,a.mount,a.price,a.total,a.errmount,a.memo,a.ordeno + '-' +a.no2
	from workds[1] a
	left join workd[1] b on a.noa = b.noa
	where b.noa = @t_noa
select * from @tmp;
----------------------------------------------------------------------------------------------------------------
z_workdp2:--z_workdp2
declare @t_bdate nvarchar(10)
declare @t_edate nvarchar(10)
set @t_bdate = case when '#non'=[3] then '' else [3] end
set @t_edate = case when '#non'=[4] then char(255) else [4] end
select
	'0' gno,b.workcno,a.noq,a.productno,a.product products,a.workno,
	reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,a.wmount),1)),4,12)) wmount,a.unit,
	reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,a.mount),1)),4,12)) amount,
	reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,a.errmount),1)),4,12)) errmount
from workds[1] a
left join workd[1] b on a.noa = b.noa
where b.datea between @t_bdate and @t_edate
order by b.workcno,a.noq;