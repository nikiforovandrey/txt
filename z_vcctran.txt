z_vcctran:--z_vcctran
declare @t_accy nvarchar(10)
declare @t_bcustno nvarchar(20)
declare @t_ecustno nvarchar(20)
declare @t_bxmon nvarchar(10)
declare @t_exmon nvarchar(10)
set @t_accy = [1]
set @t_bxmon = case when '#non' =[2]  then '' else [2] end
set @t_exmon = case when '#non' = [3] then CHAR(255) else [3] end
set @t_bcustno = case when '#non' = [4] then '' else [4] end
set @t_ecustno = case when '#non' = [5] then CHAR(255) else [5] end
declare @result table(
		gno nvarchar(1),
		noa nvarchar(20),
		noq nvarchar(20),
		mon nvarchar(6),
		custno nvarchar(20),
		comp nvarchar(50),
		tel nvarchar(10),
		addr nvarchar(50),
		sales nvarchar(50),
		[sales2] nvarchar(50),
		trantype nvarchar(20),
		item nvarchar(50),
		taxrate int,
		store nvarchar(50),
		dime int,
		mount int,
		total int,
		memo nvarchar(200)
)
insert into @result
select '0' gno,a.noa,b.noq,a.mon,a.custno,a.comp,a.tel,a.addr,a.sales,a.sales2,a.trantype,b.item,a.taxrate,
case when  LEN(c.nick)>0 then c.nick else LEFT(b.store,3) end,b.dime,b.mount,b.total,b.memo
from vcc[1] a
left join vccs[1] b on b.noa = a.noa
left join acomp c on c.noa = b.storeno
where (a.custno between @t_bcustno and @t_ecustno) and
(a.mon between @t_bxmon and @t_exmon)

select gno,noa,noq,mon,custno,comp,tel,addr,sales,sales2,trantype,item,taxrate,store,dime,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,mount),1)),4,12)) mount,
reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,total),1)),4,12)) total,memo
from @result;