z_lcu1:--z_lcu1
	declare @t_lcno nvarchar(50)
	declare @t_typea nvarchar(50)
	declare @t_bcustno nvarchar(50)
	declare @t_ecustno nvarchar(50)
	declare @t_bidate nvarchar(10)
	declare @t_eidate nvarchar(10)
	declare @t_bedate nvarchar(10)
	declare @t_eedate nvarchar(10)
	declare @t_bndate nvarchar(10)
	declare @t_endate nvarchar(10)
	
	set @t_lcno = case when '#non'=[2] then '' else [2] end
	set @t_typea = case when '#non'=[3] then '' else [3] end
	set @t_bcustno = case when '#non'=[4] then '' else [4] end
	set @t_ecustno = case when '#non'=[5] then char(255) else [5] end
	set @t_bidate = case when '#non'=[6] then '' else [6] end
	set @t_eidate = case when '#non'=[7] then char(255) else [7] end
	set @t_bedate = case when '#non'=[8] then '' else [8] end
	set @t_eedate = case when '#non'=[9] then char(255) else [9] end
	set @t_bndate = case when '#non'=[10] then '' else [10] end
	set @t_endate = case when '#non'=[11] then char(255) else [11] end
	
	--*****************************************************************************************	
select '0'gno,a.lcno,case when a.typea='1' then '即期' else '遠期' end typea
,a.custno,a.comp custcomp
,a.cno,a.acomp
,a.issuingbankno ibankno,a.issuingbank ibanks
,a.advisingbankno abankno,a.advisingbank abanks
,a.negotiatingbankno nbankno,a.negotiatingbank nbanks
,a.coin,a.floata
--,a.money,a.money-isnull((select SUM(money) from lcv where lcno=a.lcno),0) unpay
,reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,a.money),1)),4,12)) money
,reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,a.money-isnull((select SUM(money) from lcv where lcno=a.lcno),0)),1)),4,12)) unpay
,a.issuedate idate,a.edate
,a.onboarddate odate,a.negotiatingdate ndate
,d.noa ummno,d.datea ummdate
,c.noa vccno,c.datea vccdate--,c.total vcctotal
,reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,c.total),1)),4,12)) vcctotal
from lcu a left join ordei102 b on a.lcno=b.lcno
left join vcc102 c on c.ordeno=b.noa
left join umms d on d.vccno=c.noa
where (len(@t_lcno)=0 or @t_lcno=a.lcno) and  (len(@t_typea)=0 or a.typea=@t_typea )
and (a.custno between @t_bcustno and @t_ecustno) 
and (a.issuedate between @t_bidate and @t_eidate) 
and (a.edate between @t_bedate and @t_eedate) 
and (a.negotiatingdate between @t_bndate and @t_endate) 

;
--*********************************************************************************************