z_tranorde1:--z_tranorde1
declare @t_bstrdate nvarchar(10)
declare @t_estrdate nvarchar(10)
declare @t_bdldate nvarchar(10)
declare @t_edldate nvarchar(10)
declare @t_bcust nvarchar(10)
declare @t_ecust nvarchar(10)
set @t_bstrdate = case when '#non'=[3] then '' else [3] end
set @t_estrdate = case when '#non'=[4] then char(255) else [4] end
set @t_bdldate = case when '#non'=[5] then '' else [5] end
set @t_edldate = case when '#non'=[6] then char(255) else [6] end
set @t_bcust = case when '#non'=[7] then '' else [7] end
set @t_ecust = case when '#non'=[8] then char(255) else [8] end
declare @tmp table(
	gno nvarchar(1),
	noa nvarchar(30),
	datea nvarchar(10),
	strdate nvarchar(10),
	dldate nvarchar(10),
	custno nvarchar(20),
	tranquatno nvarchar(20),
	deliveryno nvarchar(20),
	acomp nvarchar(50),
	contract nvarchar(20),
	stype nvarchar(20),
	product nvarchar(50),
	po nvarchar(30),
	mount decimal(12, 3),
	unit nvarchar(10),
	addr nvarchar(40),
	cancel nvarchar(20),
	memo nvarchar(100),
	boat nvarchar(90),
	boatname nvarchar(50),
	ship nvarchar(50),
	do1 nvarchar(20),
	so nvarchar(20),
	casetype nvarchar(20),
	port nvarchar(50),
	dock nvarchar(50),
	cldate nvarchar(10),
	nodate nvarchar(10),
	takeno nvarchar(20),
	trackno nvarchar(20),
	casepresent nvarchar(20),
	caseassign nvarchar(20),
	port2 nvarchar(50),
	do2 nvarchar(20),
	checkself nvarchar(20),
	casetype2 nvarchar(20),
	checkInstru nvarchar(20),
	casedo nvarchar(20),
	madate nvarchar(10),
	redate nvarchar(10)
)
insert into @tmp
select 
	/*訂單資料*/
	'0',noa,datea,strdate,dldate,custno,tranquatno,deliveryno,
	acomp,contract,stype,product,po,mount,unit,addr,cancel,memo,
	/*出口櫃*/
	boat,boatname,ship,do1,so,casetype,port,dock,cldate,nodate,
	/*進口櫃*/
	takeno,trackno,casepresent,caseassign,port2,do2,checkself,casetype2,checkInstru,casedo,madate,redate
 from tranorde[1]
 where (strdate between @t_bstrdate and @t_estrdate) and (dldate between @t_bdldate and @t_edldate) and (custno between @t_bcust and @t_ecust)
 insert into @tmp(gno) values('1')
 select * from @tmp order by strdate,dldate,custno;
