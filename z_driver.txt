z_driver1:--z_driver1
	declare @t_accy nvarchar(10)	
	declare @t_bdriverno nvarchar(20)
	declare @t_edriverno nvarchar(20)
	
	set @t_accy = '[1]'
	set @t_bdriverno = case when '#non'=[2] then '' else [2] end
	set @t_edriverno = case when '#non'=[3] then CHAR(255) else [3] end
	------------------------------------------------------------------------------------
	declare @tmp table(
		gno nvarchar(3),
		recno int,
		cno nvarchar(20),
		acomp nvarchar(20),
		driverno nvarchar(20),
		driver nvarchar(20),
		labor float,
		health float,
		pensionfund float,
		[money] float,
		dependents int,
		memo nvarchar(max)
	)
	insert into @tmp
	select '0',ROW_NUMBER()over(order by a.cardealno,a.noa),isnull(a.cardealno,''),isnull(b.acomp,'')
	,a.noa,a.namea,a.labor,a.health,a.pensionfund,a.[money],a.dependents,a.memo
	from driver a
	left join acomp b on a.cardealno=b.noa
	where a.cartype='公司車' and len(a.mark)=0 and (a.noa between @t_bdriverno and @t_edriverno)
	order by a.cardealno,a.noa
	
	insert into @tmp
	select '1',null,cno,acomp,'','',SUM(labor),SUM(health),SUM(pensionfund),SUM([money]),SUM(dependents),''
	from @tmp where gno='0' group by cno,acomp
	
	select * from @tmp order by cno,ISNULL(recno,9999);