z_oil:
declare @t_bdate nvarchar(10)
declare @t_edate nvarchar(10)
declare @t_carno nvarchar(20)
declare @t_bdriverno nvarchar(20)
declare @t_edriverno nvarchar(20)
declare @t_boilstationno nvarchar(20)
declare @t_eoilstationno nvarchar(20)
declare @t_xproduct nvarchar(50)
set @t_bdate = case when '#non'=[1] then '' else [1] end
set @t_edate = case when '#non'=[2] then char(255) else [2] end
set @t_carno = case when '#non'=[3] then '' else [3] end
set @t_bdriverno = case when '#non'=[4] then '' else [4] end
set @t_edriverno = case when '#non'=[5]then char(255) else [5] end
set @t_boilstationno = case when '#non'=[6] then '' else [6] end
set @t_eoilstationno = case when '#non'=[7] then char(255) else [7] end
set @t_xproduct = case when '#non'=[8] then '' else [8] end
declare @result table(
		gno nvarchar(1),
		noa nvarchar(30),
		datea nvarchar(10),
		[carno] nvarchar(20),
		driverno nvarchar(20),
		driver nvarchar(50),
		oilstationno nvarchar(20),
		oilstation nvarchar(20),
		product nvarchar(50),
		price float,
		mount float,
		[money] float,
		worker nvarchar(20),
		memo nvarchar(200)
)
insert into @result
select '0' gno,noa,datea,carno,driverno,driver,oilstationno,oilstation,product,price,mount,
money,worker,memo
from oil

where (datea between @t_bdate and @t_edate) and
(LEN(@t_carno)=0 or carno=@t_carno) and
(driverno between @t_bdriverno and @t_edriverno) and
(isnull(oilstationno,'') between @t_boilstationno and @t_eoilstationno) and
(LEN(@t_xproduct)=0 or product=@t_xproduct)
select *
from @result
order by datea;