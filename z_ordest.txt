z_ordest3:--z_ordest3
declare @t_bodate nvarchar(10)
declare @t_eodate nvarchar(10)
declare @t_noa nvarchar(30)
set @t_bodate = case when '#non'=[2] then '' else [2] end
set @t_eodate = case when '#non'=[3] then char(255) else [3] end
set @t_noa = case when '#non'=[4] then '' else [4] end
declare @tmp table(
	gno nvarchar(1),
	custno nvarchar(30),
	custnick nvarchar(50),
	products nvarchar(90),
	sizea nvarchar(90),
	ordeno nvarchar(30),
	theory float,
	weight float,
	notv float,
	mount float,
	datea nvarchar(10)
)
insert into @tmp
	select 
		'0',b.custno,c.nick,a.product,
		case upper(left(b.kind,1)) when 'A' then cast(isnull(a.dime,0) as nvarchar) + ' x ' + cast(isnull(a.width,0) as nvarchar) + ' x ' + cast(isnull(a.lengthb,0) as nvarchar)
			when 'B' then cast(isnull(a.radius,0) as nvarchar) + ' x ' + cast(isnull(a.width,0) as nvarchar) + ' x ' + cast(isnull(a.dime,0) as nvarchar) + ' x ' + cast(isnull(a.lengthb,0) as nvarchar)
			else cast(isnull(a.lengthb,0) as nvarchar) end sizea,
			b.noa,a.theory,a.weight,a.notv,a.mount,a.datea
	from view_ordes102 a
	left join view_orde102 b on a.noa = b.noa
	left join cust c on b.custno = c.noa
	where (a.mount>0) and (b.odate between @t_bodate and @t_eodate) and
		(len(@t_noa) = 0 or b.noa = @t_noa)
	order by b.custno,a.product,b.noa,b.odate,b.datea
select
	gno,custno,custnick,products,sizea,ordeno,theory,weight,notv,mount,datea
from @tmp order by gno,ordeno,datea,products;
