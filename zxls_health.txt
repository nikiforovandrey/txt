zxls_health:--zxls_health.txt
declare @bbm table (
	[noa] [nvarchar](20) NOT NULL,
	[rate] [decimal](5, 2) NULL,
	[he_person] [decimal](2, 0) NULL,
	[he_comp] [decimal](2, 0) NULL
)

declare @bbs table (
	[noa] [nvarchar](20) NOT NULL,
	[noq] [nvarchar](20) NOT NULL,
	[class] [nvarchar](20) NULL,
	[salary1] [float] NULL,
	[salary2] [float] NULL,
	[lmoney] [float] NULL,
	[as_gover] [float] NULL,
	[he_person] [float] NULL,
	[he_comp] [float] NULL
)

declare @noa nvarchar(20)
declare @noq nvarchar(20)
declare @person float
declare @comp float
declare @gover float
declare @lmoney float
declare @t_lmoney float

declare @thisyear nvarchar(10) = left(CONVERT (VARCHAR(7), GETDATE(),12 )+0890000,3)
set @noa=@thisyear+'/01/01'
set @t_lmoney=0
insert into @bbm
	select @noa,4.91,30,60
--a等級,b投保金額,c自付金額,g公司負擔,h政府輔助差額
declare cursor_table cursor for
select a,cast(replace(b,',','') as float),cast(replace(c,',','') as float),cast(replace(g,',','') as float),cast(replace(h,',','') as float) from ztmpxls where isnull(ltrim(rtrim(b)),'')!='' and cast(noa as int) >=5 order by cast(noa as int)
open cursor_table
fetch next from cursor_table
into @noq,@lmoney,@person,@comp,@gover
while(@@FETCH_STATUS <> -1)
begin
	insert into @bbs
	select @noa,right('000'+@noq,3),@noq,@t_lmoney,@lmoney,@lmoney,@gover,@person,@comp
	set @t_lmoney=@lmoney+1
	fetch next from cursor_table
	into @noq,@lmoney,@person,@comp,@gover
end
close cursor_table
deallocate cursor_table
delete labhealth where noa=@noa
insert into labhealth(noa,rate,he_person,he_comp)
	select noa,rate,he_person,he_comp from @bbm
delete labhealths where noa=@noa
insert into labhealths(noa,noq,class,salary1,salary2,lmoney,as_gover,he_person,he_comp)
	select noa,noq,class,salary1,salary2,lmoney,as_gover,he_person,he_comp from @bbs;