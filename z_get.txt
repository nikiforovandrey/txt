z_get1:--z_get1
declare @t_accy nvarchar(20)
declare @t_bnoa nvarchar(20)
declare @t_enoa nvarchar(20)
set @t_accy = '[1]'
set @t_bnoa = case when '#non' = [2] then ' ' else [2] end
set @t_enoa = case when '#non' = [3] then CHAR(255) else [3] end
declare @tmp table(
		gno nvarchar(1),
		noa nvarchar(30),
		datea nvarchar(10),
		custno nvarchar(20),
		comp nvarchar(50),
		typea nvarchar(10),
		tel nvarchar(20),
		fax nvarchar(20),
		addr nvarchar(90),
		trantype nvarchar(20),
		s nvarchar(20),
		uno nvarchar(20),
		spec nvarchar(20),
		class nvarchar(20),
		product nvarchar(50),
		d float,
		w float,
		l float,
		mount float,
		weigthb float,
		memo nvarchar(200),
		cardeal nvarchar(50),
		carno nvarchar(20),
		tmemo nvarchar(200)
)
insert into @tmp
select '0' gno,a.noa,a.datea,a.custno,a.comp,a.typea,c.tel,c.fax,c.addr_comp,a.trantype,d.source,
b.uno,d.spec,d.class,b.product,b.dime,b.width,b.lengthb,b.mount,b.weight,b.memo,a.cardeal,a.carno,a.memo
from get[1] a
left join gets[1] b on a.noa = b.noa
left join cust c on a.custno = c.noa 
left join uccc d on d.noa = b.uno
where a.noa between @t_bnoa and @t_enoa

insert into @tmp
select '1' gno,noa,'','','','','','','','','','','','','','','','',SUM(mount),SUM(weigthb),'','','',''
from @tmp
group by noa

select *
from @tmp
order by noa,gno;
--*********************************************************************************************************************
z_get2:--z_get2
declare @t_accy nvarchar(20)
declare @t_itype nvarchar(10)
declare @t_bdate nvarchar(20)
declare @t_edate nvarchar(20)
declare @t_bdime decimal(7,3)
declare @t_edime decimal(7,3)
set @t_accy = '[1]'
set @t_itype = case when '#non' = [4] then '' when '全部'=[4] then '' else [4] end
set @t_bdate = case when '#non' = [5] then '' else [5] end
set @t_edate = case when '#non' = [6] then CHAR(255) else [6] end
set @t_bdime = case when '#non' = [7] then 0 else [7] end
set @t_edime = case when '#non' = [8] then 999.999 else [8] end
declare @tmp table(
		gno nvarchar(1),
		noa nvarchar(30),
		noq nvarchar(20),
		typea nvarchar(20),
		datea nvarchar(10),
		comp nvarchar(10),
		uno nvarchar(20),
		product nvarchar(20),
		spec nvarchar(20),
		sr float,
		lr float,
		d float,
		w float,
		l float,
		mount float,
		weightb float,
		price float,
		moneys float
)
insert into @tmp
select '0' gno,a.noa,b.noq,a.typea,a.datea,a.comp,b.uno,b.product,b.spec,b.sradius,b.lradius,b.dime,b.width,b.lengthb,
b.mount,b.weight,c.sprice,b.weight*c.price
from get[1] a
left join  gets[1] b on a.noa = b.noa
left join uccc c on c.noa = b.uno
where  (LEN(@t_itype)= 0 or @t_itype = a.typea) and
(a.datea between @t_bdate and @t_edate ) and
(b.dime between @t_bdime and @t_edime)

insert into @tmp
select '1' gno,'','','','','','','','','','',0,0,0,SUM(mount),SUM(weightb),0,SUM(moneys)
from @tmp

select *
from @tmp;
--***********************************************************************************************************************
z_getyd3:--z_getyd3
declare @t_accy nvarchar(20)
declare @t_bnoa nvarchar(20)
declare @t_enoa nvarchar(20)
set @t_accy = '[1]'
set @t_bnoa = case when '#non' = [2] then ' ' else [2] end
set @t_enoa = case when '#non' = [3] then CHAR(255) else [3] end
declare @tmp table(
		gno nvarchar(1),
		noa nvarchar(20),
		custno nvarchar(20),
		comp nvarchar(50),
		datea nvarchar(20),
		tel nvarchar(20),
		addr nvarchar(50),
		serial nvarchar(20),
		product nvarchar(50),
		d float,
		w float,
		l float,
		mount float,
		weightb float,
		eweight float,
		unit nvarchar(20),
		price float,
		moneys float,
		memo nvarchar(200),
		carno nvarchar(20),
		trantype nvarchar(20)
)
insert into @tmp
select '0' gno,a.noa,a.custno,a.comp,a.datea,c.tel,c.addr_fact,c.serial,b.product,b.dime,b.width,b.lengthb,
b.mount,b.weight,b.eweight,b.unit,d.sprice,b.weight*d.sprice,b.memo,a.carno,a.trantype
from get[1] a
left join gets[1] b on a.noa = b.noa
left join cust c on a.custno = c.noa
left join uccc d on b.uno = a.noa
where (a.noa between @t_bnoa and @t_enoa)

insert into @tmp
select '1' gno,noa,'','','','','','','',0,0,0,0,SUM(weightb),0,'',0,0,'',MAX(carno),MAX(trantype)
from @tmp
group by noa

select *
from @tmp
order by noa,gno;





