z_cuwp1:--z_cuwp1
IF OBJECT_ID('tempdb..#tmp')is not null
BEGIN
	drop table #tmp
END
IF OBJECT_ID('tempdb..#tmpa')is not null
BEGIN
	drop table #tmpa
END
declare @t_bdate nvarchar(10)
declare @t_edate nvarchar(10)
declare @t_bstationno nvarchar(50)
declare @t_estationno nvarchar(50)
set @t_bdate = case when '#non' = [2] then '102/01/01' else [2] end
set @t_edate = case when '#non' = [3] then '102/01/31' else [3] end 
set @t_bstationno = case when '#non' = [4] then '' else [4] end
set @t_estationno = case when '#non' = [5] then char(255) else [5] end 

create table #tmp (
	gno nvarchar(3),
	idno int identity(0,1),
	title nvarchar(50),
	days01 nvarchar(30),
	days02 nvarchar(30),
	days03 nvarchar(30),
	days04 nvarchar(30),
	days05 nvarchar(30),
	days06 nvarchar(30),
	days07 nvarchar(30),
	days08 nvarchar(30),
	days09 nvarchar(30),
	days10 nvarchar(30),
	days11 nvarchar(30),
	days12 nvarchar(30),
	days13 nvarchar(30),
	days14 nvarchar(30),
	days15 nvarchar(30),
	days16 nvarchar(30),
	days17 nvarchar(30),
	days18 nvarchar(30),
	days19 nvarchar(30),
	days20 nvarchar(30),
	days21 nvarchar(30),
	days22 nvarchar(30),
	days23 nvarchar(30),
	days24 nvarchar(30),
	days25 nvarchar(30),
	days26 nvarchar(30),
	days27 nvarchar(30),
	days28 nvarchar(30),
	days29 nvarchar(30),
	days30 nvarchar(30),
	days31 nvarchar(30)
)
create table #tmpa(
	gno nvarchar(1),
	datea nvarchar(10),
	gen float,
	hours float,
	ovewtime float,
	workmount float,
	mount float,
	isovertime int
)
insert into #tmpa
	select
		'0',b.datea,c.gen,a.borntime,a.addtime,a.workmount,a.mount,a.isovertime
	from view_cuws a
	left join view_cuw b on a.noa = b.noa
	left join station c on b.stationno=c.noa
	where (b.stationno between @t_bstationno and @t_estationno)
declare @cmd nvarchar(max)
declare @Field nvarchar(max)
declare @Field_no nvarchar(10)
declare @sql_str_idno0 nvarchar(max)
declare @sql_str_idno1 nvarchar(max)
declare @sql_str_idno2 nvarchar(max)
declare @sql_str_idno3 nvarchar(max)
declare @sql_str_idno4 nvarchar(max)
declare @sql_str_idno5 nvarchar(max)
declare @sql_str_idno6 nvarchar(max)
declare @sql_str_idno7 nvarchar(max)
declare @sql_str_idno8 nvarchar(max)
declare @sql_str_idno9 nvarchar(max)
declare @sql_str_idno10 nvarchar(max)
declare @sql_str_idno11 nvarchar(max)
declare @sql_str_idno12 nvarchar(max)
declare @sql_str_idno13 nvarchar(max)
declare @sql_str_idno14 nvarchar(max)
declare @sql_str_idno15 nvarchar(max)
declare @alter_format nvarchar(max)
declare @alter_zero2empty nvarchar(max)
declare @i int
set @Field = ''
set @Field_no = ''
set @sql_str_idno0 = 'select 0,''日期'','
set @sql_str_idno1 = 'select 0,''基本產能'','
set @sql_str_idno2 = 'select 0,''工時'','
set @sql_str_idno3 = 'select 0,''工時累計'','
set @sql_str_idno4 = 'select 0,''製令工時'','
set @sql_str_idno5 = 'select 0,''製令工時累計'','
set @sql_str_idno6 = 'select 0,''製令數'','
set @sql_str_idno7 = 'select 0,''製令數累計'','
set @sql_str_idno8 = 'select 0,''完工數量'','
set @sql_str_idno9 = 'select 0,''完工數量累計'','
set @sql_str_idno10 = 'select 0,''加班製令數'','
set @sql_str_idno11 = 'select 0,''加班製令數累計'','
set @sql_str_idno12 = 'select 0,''加班產量'','
set @sql_str_idno13 = 'select 0,''加班產量累計'','
set @sql_str_idno14 = 'select 0,''加班時數'','
set @sql_str_idno15 = 'select 0,''加班累計'','
set @alter_format = 'update #tmp set'
set @alter_zero2empty = ''
set @i = 1
while(@i < 32)
begin
	set @Field_no = RIGHT(REPLICATE('0', 2) + CAST(@i as NVARCHAR), 2)
	set @Field += 'days' + @Field_no + ','
	set @sql_str_idno0 += '''' +  left(@t_bdate,7) + @Field_no + ''','
	set @sql_str_idno1 += '(select sum(isnull(gen,0)) from #tmpa where datea = (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @sql_str_idno2 += '(select sum(isnull(hours,0)) from #tmpa where isovertime=0 and datea = (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @sql_str_idno3 += '(select sum(isnull(hours,0)) from #tmpa where isovertime=0 and datea <= (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @sql_str_idno4 += '0,'
	set @sql_str_idno5 += '0,'
	set @sql_str_idno6 += '(select sum(isnull(workmount,0)) from #tmpa where isovertime=0 and datea = (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @sql_str_idno7 += '(select sum(isnull(workmount,0)) from #tmpa where isovertime=0 and datea <= (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @sql_str_idno8 += '(select sum(isnull(mount,0)) from #tmpa where isovertime=0 and datea = (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @sql_str_idno9 += '(select sum(isnull(mount,0)) from #tmpa where isovertime=0 and datea <= (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @sql_str_idno10 += '(select sum(isnull(workmount,0)) from #tmpa where isovertime=1 and datea = (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @sql_str_idno11 += '(select sum(isnull(workmount,0)) from #tmpa where isovertime=1 and datea <= (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @sql_str_idno12 += '(select sum(isnull(mount,0)) from #tmpa where isovertime=1 and datea = (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @sql_str_idno13 += '(select sum(isnull(mount,0)) from #tmpa where isovertime=1 and datea <= (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @sql_str_idno14 += '(select sum(isnull(hours,0)) from #tmpa where isovertime=1 and datea = (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @sql_str_idno15 += '(select sum(isnull(hours,0)) from #tmpa where isovertime=1 and datea <= (select days' +@Field_no +  ' from #tmp where idno = 0)),'
	set @alter_format += ' days' + @Field_no + ' = 	reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(cast(days' + @Field_no + ' as float),0)),1)),4,12)), '
	set @alter_zero2empty += 'update #tmp set days' + @Field_no + ' = '''' where idno != 0 and days' + @Field_no + ' =''0'' '
	set @i += 1
end
begin ------idno=0
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno0,0,len(@sql_str_idno0))
	exec(@cmd)
end
begin ------idno=1
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno1,0,len(@sql_str_idno1))
	exec(@cmd)
end
begin ------idno=2
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno2,0,len(@sql_str_idno2))
	exec(@cmd)
end
begin ------idno=3
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno3,0,len(@sql_str_idno3))
	exec(@cmd)
end
begin ------idno=4
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno4,0,len(@sql_str_idno4))
	exec(@cmd)
end
begin ------idno=5
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno5,0,len(@sql_str_idno5))
	exec(@cmd)
end
begin ------idno=6
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno6,0,len(@sql_str_idno6))
	exec(@cmd)
end
begin ------idno=7
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno7,0,len(@sql_str_idno7))
	exec(@cmd)
end
begin ------idno=8
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno8,0,len(@sql_str_idno8))
	exec(@cmd)
end
begin ------idno=9
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno9,0,len(@sql_str_idno9))
	exec(@cmd)
end
begin ------idno=10
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno10,0,len(@sql_str_idno10))
	exec(@cmd)
end
begin ------idno=11
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno11,0,len(@sql_str_idno11))
	exec(@cmd)
end
begin ------idno=12
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno12,0,len(@sql_str_idno12))
	exec(@cmd)
end
begin ------idno=13
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno13,0,len(@sql_str_idno13))
	exec(@cmd)
end
begin ------idno=14
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno14,0,len(@sql_str_idno14))
	exec(@cmd)
end
begin ------idno=15
	set @cmd = 'insert into #tmp (gno,title,' + substring(@Field,0,len(@Field)) + ') ' +  substring(@sql_str_idno15,0,len(@sql_str_idno15))
	exec(@cmd)
end
begin ------修改數字格式
	set @cmd = substring(@alter_format,0,len(@alter_format)) + ' where idno != 0'
	exec(@cmd)
end
begin ------為0則清空
	set @cmd = @alter_zero2empty
	exec(@cmd)
end
------取某月最後一天
declare @lastDay nvarchar(10)
set @lastDay = cast((cast(left(@t_bdate,3) as int) + 1911) as nvarchar) + substring(@t_bdate,4,3) + '/01'
set @lastDay = right(CONVERT(nvarchar(10),DATEADD(ss, -1, DATEADD(m,1,@lastDay)),111),2)+1
------取某月最後一天
while(cast(@lastDay as int) < 32 )
begin
	set @cmd = 'update #tmp set days' + @lastDay + '= '''''
	exec(@cmd)
	set @lastDay = cast((cast(@lastDay as int)+1) as nvarchar)
end
update #tmp set gno = idno
select * from #tmp
IF OBJECT_ID('tempdb..#tmp')is not null
BEGIN
	drop table #tmp
END
IF OBJECT_ID('tempdb..#tmpa')is not null
BEGIN
	drop table #tmpa
END;
---------------------------------------------------------------------*
z_cuwp2:--z_cuwp2
IF OBJECT_ID('tempdb..#tmp')is not null
BEGIN
       drop table #tmp
END
declare @t_bdate nvarchar(10)
declare @t_edate nvarchar(10)
declare @t_bstationno nvarchar(50)
declare @t_estationno nvarchar(50)
set @t_bdate = case when '#non' = [2] then '102/01/01' else [2] end
set @t_edate = case when '#non' = [3] then '102/01/31' else [3] end 
set @t_bstationno = case when '#non' = [4] then '' else [4] end
set @t_estationno = case when '#non' = [5] then char(255) else [5] end 
 
create table #tmp (
	gno nvarchar(3),
	idno int identity(0,1),
	title nvarchar(50),
	station0 nvarchar(90),
	station1 nvarchar(90),
	station2 nvarchar(90),
	station3 nvarchar(90),
	station4 nvarchar(90),
	station5 nvarchar(90),
	station6 nvarchar(90),
	station7 nvarchar(90),
	station8 nvarchar(90),
	station9 nvarchar(90),
	station_a nvarchar(90),
	station_b nvarchar(90),
	station_c nvarchar(90),
	station_d nvarchar(90),
	station_e nvarchar(90),
	station_f nvarchar(90),
	station_g nvarchar(90),
	station_h nvarchar(90),
	station_i nvarchar(90)
)
declare @station_title nvarchar(max)
declare @cmd nvarchar(max)
declare @i int
set @i = 0
set @station_title =  '''工作中心編號''' + ','
set @cmd = ''
declare @station nvarchar(90)
declare cursor_table cursor for
select noa from  station
open cursor_table
fetch next from cursor_table
into @station
while(@@FETCH_STATUS <> -1)
begin
	set @station_title += '''' + @station + '''' + ',' 
	set @i +=1
	fetch next from cursor_table
	into @station
end
close cursor_table
deallocate cursor_table
while(@i < (18 + 1))
begin
	set @station_title += '''''' + ','
	set @i += 1
end
set @station_title = '0,' + @station_title
if(right(@station_title,1) = ',')
	set @station_title = substring(@station_title,0,len(@station_title))
set @cmd = 'select '  + @station_title
insert into #tmp ------idno=0
	exec(@cmd)
declare @tmp table(
	gno nvarchar(1),
	stationno nvarchar(30),
	station nvarchar(90),
	gen float,
	borntime float,
	addtime float,
	chgtime float,
	faulttime float,
	delaytime float,
	waittime float,
	waitfedtime float,
	lacksss float,
	workmount float,
	mount float,
	mans float,
	supmans float,
	isovertime int
)
insert into @tmp
	select
		'0',a.stationno,a.station,d.gen,b.borntime,b.addtime,b.chgtime,b.faulttime,
		b.delaytime,b.waittime,b.waitfedtime,b.lacksss,b.workmount,
		b.mount,c.mans,c.supmans,b.isovertime
	from view_cuw a
	left join view_cuws b on a.noa = b.noa
	outer apply(select SUM(mans) mans,SUM(supmans) supmans from view_cuwt where noa=a.noa) c
	left join station d on a.stationno=d.noa
	where (a.datea between @t_bdate and @t_edate) and
		  (isnull(a.stationno,'') != '') and
		  (a.stationno between @t_bstationno and @t_estationno)
insert into #tmp ------基本產能 idno=1
	select 0,'基本產能'
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(gen,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------工時 idno=2
	select 0,'工時'
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(borntime,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------製令工時 idno=3
	select 0,'製令工時'
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------製令工時累計 idno=4
	select 0,'製令工時累計	'
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station0 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station1 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station2 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station3 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station4 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station5 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station6 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station7 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station8 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station9 from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station_a from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station_b from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station_c from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station_d from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station_e from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station_f from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station_g from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station_h from #tmp where idno = 0))
	,(select sum(isnull(isnull(borntime,0)+isnull(addtime,0),0)) from @tmp where stationno <= (select station_i from #tmp where idno = 0))
insert into #tmp ------製令數 idno=5
	select 0,'製令數'
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------製令數累計 idno=6
	select 0,'製令數累計'
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station0 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station1 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station2 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station3 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station4 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station5 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station6 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station7 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station8 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station9 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station_a from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station_b from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station_c from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station_d from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station_e from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station_f from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station_g from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station_h from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where stationno <= (select station_i from #tmp where idno = 0))
insert into #tmp ------完工數量 idno=7
	select 0,'完工數量'
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------完工數量累計 idno=8
	select 0,'完工數量累計'
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station0 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station1 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station2 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station3 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station4 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station5 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station6 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station7 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station8 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station9 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station_a from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station_b from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station_c from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station_d from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station_e from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station_f from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station_g from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station_h from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where stationno <= (select station_i from #tmp where idno = 0))
insert into #tmp ------加班製令數 idno=9
	select 0,'加班製令數'
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------加班製令數累計 idno=10
	select 0,'加班製令數累計'
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station0 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station1 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station2 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station3 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station4 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station5 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station6 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station7 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station8 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station9 from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station_a from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station_b from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station_c from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station_d from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station_e from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station_f from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station_g from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station_h from #tmp where idno = 0))
	,(select sum(isnull(workmount,0)) from @tmp where isovertime=1 and stationno <= (select station_i from #tmp where idno = 0))
insert into #tmp ------加班產量 idno=11
	select 0,'加班產量'
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------加班產量累計 idno=12
	select 0,'加班產量累計'
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station0 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station1 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station2 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station3 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station4 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station5 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station6 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station7 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station8 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station9 from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station_a from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station_b from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station_c from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station_d from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station_e from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station_f from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station_g from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station_h from #tmp where idno = 0))
	,(select sum(isnull(mount,0)) from @tmp where isovertime=1 and stationno <= (select station_i from #tmp where idno = 0))
insert into #tmp ------加班時數 idno=13
	select 0,'加班時數'
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------加班累計 idno=14
	select 0,'加班累計'
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station0 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station1 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station2 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station3 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station4 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station5 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station6 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station7 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station8 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station9 from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station_a from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station_b from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station_c from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station_d from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station_e from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station_f from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station_g from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station_h from #tmp where idno = 0))
	,(select sum(isnull(addtime,0)) from @tmp where stationno <= (select station_i from #tmp where idno = 0))
insert into #tmp ------換膜 idno=15
	select 0,'換膜'
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------換膜累計 idno=16
	select 0,'換膜累計'
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station0 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station1 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station2 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station3 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station4 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station5 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station6 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station7 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station8 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station9 from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station_a from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station_b from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station_c from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station_d from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station_e from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station_f from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station_g from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station_h from #tmp where idno = 0))
	,(select sum(isnull(chgtime,0)) from @tmp where stationno <= (select station_i from #tmp where idno = 0))
insert into #tmp ------故障 idno=17
	select 0,'故障'
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------故障累計 idno=18
	select 0,'故障累計'
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station0 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station1 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station2 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station3 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station4 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station5 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station6 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station7 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station8 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station9 from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station_a from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station_b from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station_c from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station_d from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station_e from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station_f from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station_g from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station_h from #tmp where idno = 0))
	,(select sum(isnull(faulttime,0)) from @tmp where stationno <= (select station_i from #tmp where idno = 0))
insert into #tmp ------延遲 idno=19
	select 0,'延遲'
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------延遲累計 idno=20
	select 0,'延遲累計'
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station0 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station1 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station2 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station3 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station4 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station5 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station6 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station7 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station8 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station9 from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station_a from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station_b from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station_c from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station_d from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station_e from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station_f from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station_g from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station_h from #tmp where idno = 0))
	,(select sum(isnull(delaytime,0)) from @tmp where stationno <= (select station_i from #tmp where idno = 0))
insert into #tmp ------待單 idno=21
	select 0,'待單'
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------待單累計 idno=22
	select 0,'待單累計'
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station0 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station1 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station2 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station3 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station4 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station5 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station6 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station7 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station8 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station9 from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station_a from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station_b from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station_c from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station_d from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station_e from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station_f from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station_g from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station_h from #tmp where idno = 0))
	,(select sum(isnull(waittime,0)) from @tmp where stationno <= (select station_i from #tmp where idno = 0))
insert into #tmp ------待料 idno=23
	select 0,'待料'
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------待料累計 idno=24
	select 0,'待料累計'
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station0 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station1 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station2 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station3 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station4 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station5 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station6 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station7 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station8 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station9 from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station_a from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station_b from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station_c from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station_d from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station_e from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station_f from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station_g from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station_h from #tmp where idno = 0))
	,(select sum(isnull(waitfedtime,0)) from @tmp where stationno <= (select station_i from #tmp where idno = 0))
insert into #tmp ------缺員 idno=25
	select 0,'缺員'
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------缺員累計 idno=26
	select 0,'缺員累計'
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station0 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station1 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station2 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station3 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station4 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station5 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station6 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station7 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station8 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station9 from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station_a from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station_b from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station_c from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station_d from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station_e from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station_f from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station_g from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station_h from #tmp where idno = 0))
	,(select sum(isnull(lacksss,0)) from @tmp where stationno <= (select station_i from #tmp where idno = 0))
insert into #tmp ------人員編制 idno=27
	select 0,'人員編制'
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(mans,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------人員支援 idno=28
	select 0,'人員支援'
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station0 from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station1 from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station2 from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station3 from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station4 from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station5 from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station6 from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station7 from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station8 from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station9 from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station_a from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station_b from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station_c from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station_d from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station_e from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station_f from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station_g from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station_h from #tmp where idno = 0))
	,(select sum(isnull(supmans,0)) from @tmp where stationno = (select station_i from #tmp where idno = 0))
insert into #tmp ------人員間接 idno=29
	select 0,'人員間接'
	,0
	,0
	,0
	,0
	,0
	,0
	,0
	,0
	,0
	,0
	,0
	,0
	,0
	,0
	,0
	,0
	,0
	,0
	,0

update #tmp set gno = idno
-------修改數字格式
update #tmp set station0 = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station0,0)),1)),4,12)) where idno != 0
update #tmp set station1 = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station1,0)),1)),4,12)) where idno != 0
update #tmp set station2 = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station2,0)),1)),4,12)) where idno != 0
update #tmp set station3 = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station3,0)),1)),4,12)) where idno != 0
update #tmp set station4 = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station4,0)),1)),4,12)) where idno != 0
update #tmp set station5 = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station5,0)),1)),4,12)) where idno != 0
update #tmp set station6 = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station6,0)),1)),4,12)) where idno != 0
update #tmp set station7 = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station7,0)),1)),4,12)) where idno != 0
update #tmp set station8 = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station8,0)),1)),4,12)) where idno != 0
update #tmp set station9 = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station9,0)),1)),4,12)) where idno != 0
update #tmp set station_a = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station_a,0)),1)),4,12)) where idno != 0
update #tmp set station_b = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station_b,0)),1)),4,12)) where idno != 0
update #tmp set station_c = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station_c,0)),1)),4,12)) where idno != 0
update #tmp set station_d = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station_d,0)),1)),4,12)) where idno != 0
update #tmp set station_e = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station_e,0)),1)),4,12)) where idno != 0
update #tmp set station_f = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station_f,0)),1)),4,12)) where idno != 0
update #tmp set station_g = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station_g,0)),1)),4,12)) where idno != 0
update #tmp set station_h = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station_h,0)),1)),4,12)) where idno != 0
update #tmp set station_i = reverse(substring(reverse(convert(nvarchar(15),CONVERT(money,isnull(station_i,0)),1)),4,12)) where idno != 0
-------為0則清空
update #tmp set station0 = '' where idno != 0 and station0 <=0 and idno <33
update #tmp set station1 = '' where idno != 0 and station1 <=0 and idno <33
update #tmp set station2 = '' where idno != 0 and station2 <=0 and idno <33
update #tmp set station3 = '' where idno != 0 and station3 <=0
update #tmp set station4 = '' where idno != 0 and station4 <=0
update #tmp set station5 = '' where idno != 0 and station5 <=0
update #tmp set station6 = '' where idno != 0 and station6 <=0
update #tmp set station7 = '' where idno != 0 and station7 <=0
update #tmp set station8 = '' where idno != 0 and station8 <=0
update #tmp set station9 = '' where idno != 0 and station9 <=0
update #tmp set station_a = '' where idno != 0 and station_a <=0
update #tmp set station_b = '' where idno != 0 and station_b <=0
update #tmp set station_c = '' where idno != 0 and station_c <=0
update #tmp set station_d = '' where idno != 0 and station_d <=0
update #tmp set station_e = '' where idno != 0 and station_e <=0
update #tmp set station_f = '' where idno != 0 and station_f <=0
update #tmp set station_g = '' where idno != 0 and station_g <=0
update #tmp set station_h = '' where idno != 0 and station_h <=0
update #tmp set station_i = '' where idno != 0 and station_i <=0
select * from #tmp
IF OBJECT_ID('tempdb..#tmp')is not null
BEGIN
       drop table #tmp
END;